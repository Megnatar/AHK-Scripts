#NoEnv  
#SingleInstance force
SendMode Input 
SetWorkingDir %A_ScriptDir% 
SetBatchLines, -1 
ListLines, off 
detectHiddenWindows, on

GameExe = ""
GamePath = ""
SomeKey = ""
Proccess_ID = ""

GroupAdd, KeysForWindow, ahk_exe %GameExe% ;#IfWin does not support variable names. Workaround 

IfWinExist, ahk_exe %GameExe%
{   
    WinActivate, ahk_exe %GameExe%
    WinWaitActive, ahk_exe %GameExe%
    WinGet, Proccess_ID, PID, ahk_exe %GameExe%,, 
} 
Else 
If WinNotExist ahk_exe %GameExe%
{
    runwait,%GameExe%, %GamePath%,,Proccess_ID   
}

SetTimer ChkProcces, 5000                 ;5 second period for checking proccess
Return

#IfWinActive, ahk_group KeysForWindow
{

bAutorun0 =
bAutorun1 = 0

Xbutton2::                                ;Toggle W, usually handy for autorun and so on.                         
If (bAutorun0 := !bAutorun0) {
    send {w down}
}Else{
    send {w up}
}
Return

Xbutton1::                               ;A other way to toggle keys
If (bAutorun1 = 0)
{
	bAutorun1++
	send {Up down}
	Return
}
If (bAutorun1 = 1)
{
	bAutorun1--
    send {Up up}
	Return
}
Return

Rbutton:: 
keywait, Rbutton, T0.32
if errorlevel = 1 
{
    while GetKeyState("Rbutton", "P")     ;Key is pressed down
    {
        send, {Rbutton down}        
        KeyWait, Rbutton 
    }
    send, {Rbutton up}  
return 
}
else
keywait, Rbutton, D T0.32                 ;Double cliked
if errorlevel = 0          
{
    send, {somekey} 
    return               
 }
else                     
Send, {click right}                       ;Clicked once
return 
}

ChkProcces:                               ;Close script when procced is not active
Process, Exist, %Proccess_ID%
If ErrorLevel = 0
Exitapp
Return
