#NoEnv  
#SingleInstance force
SendMode Input 
SetWorkingDir %A_ScriptDir% 
SetBatchLines, -1 
ListLines, off 
detectHiddenWindows, on

GameExe = ""
GamePath = ""
SomeKey = ""
Proccess_ID = ""

GroupAdd, ContextVar, ahk_exe %GameExe%

IfWinExist, ahk_exe %GameExe%
{   
    WinActivate, ahk_exe %GameExe%
    WinWaitActive, ahk_exe %GameExe%
    WinGet, Proccess_ID, PID, ahk_exe %GameExe%,, 
} 
Else 
#IfWinNotExist, ahk_group ContextVar
{
    runwait,%GameExe%, %GamePath%,,Proccess_ID   
}

SetTimer ChkProcces, 5000                 ;Close script when procced is not active
Return

#IfWinActive, ahk_group ContextVar
{
bAutorun =
Xbutton2::                                ;Toggle W, usually handy for autorun and so on.                         
If (bAutorun := !bAutorun) {
    send {w down}
}Else{
    send {w up}
}
Return

Rbutton:: 
keywait, Rbutton, T0.32
if errorlevel = 1 
{
    while GetKeyState("Rbutton", "P")     ;Key is pressed down
    {
        send, {Rbutton down}        
        KeyWait, Rbutton 
    }
    send, {Rbutton up}  
return 
}
else
keywait, Rbutton, D T0.32                 ;Double cliked
if errorlevel = 0          
{
    send, {somekey} 
    return               
 }
else                     
Send, {click right}                       ;Clicked once
return 
}

ChkProcces:                               ;Close script when procced is not active
Process, Exist, %Proccess_ID%
If ErrorLevel = 0
Exitapp
Return
