;--------------------------AutoExecute Section--------------------------
#NoEnv  
#SingleInstance force
SendMode Input 
SetWorkingDir %A_ScriptDir% 
SetBatchLines,-1 
ListLines, off 
detectHiddenWindows, on

GameExe = ""
GamePath = ""
Process_ID = ""

GroupAdd, ForThisWinOnly, ahk_exe %GameExe%  ;The #IfWin directive doesn't support variable names. Workaround 

IfWinExist, ahk_exe %GameExe%
{   
    WinActivate, ahk_exe %GameExe%
    WinGet, Process_ID, PID, ahk_exe %GameExe% 
} 
Else 
If WinNotExist ahk_exe %GameExe%
{
    run,%GameExe%, %GamePath%,,Process_ID   
}

SetTimer ChkProcess, 5000                   ;5 second period for checking process
Return                                      ;Here ends the AutoExecute Section

#IfWinActive, ahk_group ForThisWinOnly
{
;
;					                         ;Actions will be put here
;
}
                    
ChkProcess:                                   ;Close script when process isn't active anymore
Process, Exist, %Process_ID%
If ErrorLevel = 0
Exitapp
Return




